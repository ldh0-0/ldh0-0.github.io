<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Misc总结</title>
      <link href="/2021/12/08/Misc%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/08/Misc%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="图篇隐写"><a href="#图篇隐写" class="headerlink" title="图篇隐写"></a>图篇隐写</h2><h3 id="binwalk文件分离"><a href="#binwalk文件分离" class="headerlink" title="binwalk文件分离"></a>binwalk文件分离</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">binwalk [文件名] 对文件进行扫描是否有隐藏文件</span><br><span class="line">binwalk -e [文件名] 提取文件中的隐藏文件</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一届 “东软杯”网络安全CTF竞赛</title>
      <link href="/2021/12/07/%E4%B8%9C%E8%BD%AFwp1/"/>
      <url>/2021/12/07/%E4%B8%9C%E8%BD%AFwp1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>萌新第一次参加CTF比赛记录一下</p></blockquote><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><ol><li><p>只是个PNG，别想太多了.png<br>下载后发现图片打不开，之后放到Linux中用binwalk发现还有一个文件，打开后找到flag。<br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208163217.png"><br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208164910.png"></p></li><li><p>压缩包压缩包压缩包压缩包<br>打开后是一个有密码的压缩包，发现密码就是文件名。但解压了十多个压缩包后发现不对劲，直接在网上找了个python脚本跑了一会就出来了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile, os</span><br><span class="line"></span><br><span class="line">extPath = <span class="string">&quot;C:\\Users\\xxx&quot;</span> 压缩包所在路径</span><br><span class="line">file = <span class="string">&quot;xxx&quot;</span> <span class="comment">#压缩包名</span></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line">    filePath = extPath + file</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;unzip&quot;</span> + <span class="built_in">str</span>(index) + <span class="string">&quot;:&quot;</span> + filePath)</span><br><span class="line">    zFile = zipfile.ZipFile(filePath, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> fileM <span class="keyword">in</span> zFile.namelist():</span><br><span class="line">        zFile.extract(fileM, extPath, pwd = fileM[:-<span class="number">4</span>].encode())</span><br><span class="line">        file = fileM</span><br><span class="line">    zFile.close();</span><br><span class="line">    os.remove(filePath)</span><br></pre></td></tr></table></figure></li></ol><p>最后一个压缩包是23333.zip密码不是文件名，简单的暴力破解后就出来密码了。<br> <img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208165448.png"></p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><ol><li>[签到]键盘侠<br>看到一串字母随便找了一个百度UYTGBNM发现一个网址瞬间醒悟。<br><a href="https://www.fwhibbit.es/wp-content/uploads/2017/02/Write-up-Sudan.pdf">网站</a><br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208165913.png"></li><li>[萌新]素数<br>要求10个不重复的长度&gt;=1024bits的素数，网上找到python脚本一跑就出。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">miller_rabin</span>(<span class="params">p</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p == <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> p == <span class="number">2</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> p % <span class="number">2</span> == <span class="number">0</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    m, k, = p - <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> m % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        m, k = m // <span class="number">2</span>, k + <span class="number">1</span></span><br><span class="line">    a = randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">    x = <span class="built_in">pow</span>(a, m, p)</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">1</span> <span class="keyword">or</span> x == p - <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">while</span> k &gt; <span class="number">1</span>:</span><br><span class="line">        x = <span class="built_in">pow</span>(x, <span class="number">2</span>, p)</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> x == p - <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        k = k - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_prime</span>(<span class="params">p, r=<span class="number">40</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">        <span class="keyword">if</span> miller_rabin(p) == <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    T = time.perf_counter()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        index = <span class="number">1024</span></span><br><span class="line">        <span class="built_in">print</span>(index, <span class="string">&quot;位质数: &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(index):</span><br><span class="line">            num = num * <span class="number">2</span> + randint(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">while</span> is_prime(num) == <span class="literal">False</span>:</span><br><span class="line">            num = num + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(num)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;----------------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;用时：&quot;</span>, time.perf_counter() - T)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><ol><li>[签到]signin<br>直接拖进IDA后发现flag<br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208170122.png"></li><li>[萌新]happyCTF<br>先用die看了一下发现是32位的<br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208170145.png"><br>用32位IDA反汇编后看main函数按F5查看它的伪代码<br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208170207.png"><br>发现输入位数必须是24位的字符串，输入值就位flag.之后进去lambda_1b3a4e77a09e1a7ed440bad3aa4c443b_函数看发现flag被异或了20最后和key相等。<br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208170227.png"><br>所以我们用20在将key异或回去就是flag了。<br>用python跑了一下发现flag<br>这里的x是之前手动将key值对应的ascii码写出来了，其实直接在python中换就行。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="string">&quot;rxusoCqxw&#123;yqK`&#123;KZqag&#123;r`i&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">24</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(x[i]) ^ <span class="number">20</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208170312.png"><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2></li><li>签到NssShop<br>最后写件数的时候直接输7个1超出其（int范围*flag的价格）int范围<br>Flag就出来了<br><img src="https://cdn.jsdelivr.net/gh/ldh0-0/picgodemo/img/20211208170343.png"></li></ol>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
